"use strict";
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
};
Object.defineProperty(exports, "__esModule", { value: true });
const stream_1 = require("stream");
class LineSplitter extends stream_1.Transform {
    constructor(options) {
        super(Object.assign({ readableObjectMode: true }, options));
        this.internalBuffer = [];
        this.eol13 = Buffer.from('\r\n');
        this.eol10 = Buffer.from('\n');
    }
    _transform(chunk, _encoding, next) {
        var index = 0;
        var pos;
        while ((pos = chunk.indexOf(10, index)) != -1) {
            var with13 = pos && chunk[pos - 1] == 13;
            this.push({ line: Buffer.concat([...this.internalBuffer, chunk.slice(index, pos - (with13 ? 1 : 0))]), eol: with13 ? this.eol13 : this.eol10 });
            this.internalBuffer = [];
            index = pos + 1;
        }
        this.internalBuffer.push(chunk.slice(index));
        next();
    }
    _flush(done) {
        if (this.internalBuffer.length && this.internalBuffer.find(x => x.length > 0 || x.byteLength > 0)) {
            this.push({ line: Buffer.concat(this.internalBuffer), eol: Buffer.from('') });
        }
        done();
    }
}
exports.LineSplitter = LineSplitter;
class LineJoiner extends stream_1.Transform {
    constructor(options) {
        super(Object.assign({ writableObjectMode: true }, options));
    }
    _transform(chunk, _encoding, next) {
        this.push(chunk.line);
        this.push(chunk.eol);
        next();
    }
}
exports.LineJoiner = LineJoiner;
class EscapeCharsTransform extends stream_1.Transform {
    constructor(options, mode) {
        var { charsToEscape, prefixChar } = options, superOptions = __rest(options, ["charsToEscape", "prefixChar"]);
        super(Object.assign({ objectMode: mode === 'lines' }, superOptions));
        this.prefixBuffer = Buffer.alloc(1, prefixChar);
        this.charsMap = {};
        this.mode = mode;
        var self = this;
        charsToEscape.split('').forEach(function (char) {
            var ascii = char.charCodeAt(0);
            self.charsMap[ascii] = true;
        });
    }
    _transform(chunk, _encoding, next) {
        var index = 0;
        var pos = 0;
        var line;
        var parts;
        if (this.mode === 'lines') {
            parts = [];
            line = chunk.line;
        }
        else {
            parts = this;
            line = chunk;
        }
        while (pos < line.byteLength) {
            if (this.charsMap[line[pos]]) {
                parts.push(line.slice(index, pos));
                parts.push(this.prefixBuffer);
                index = pos;
            }
            pos++;
        }
        parts.push(line.slice(index));
        if (this.mode === 'lines') {
            this.push({ line: Buffer.concat(parts), eol: chunk.eol });
        }
        next();
    }
}
exports.EscapeCharsTransform = EscapeCharsTransform;
async function streamSignalsDone(stream) {
    return new Promise(function (resolve, reject) {
        stream.on('error', reject);
        stream.on('close', resolve);
        stream.on('end', resolve);
    });
}
exports.streamSignalsDone = streamSignalsDone;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGluZS1zcGxpdHRlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zZXJ2ZXIvbGluZS1zcGxpdHRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxZQUFZLENBQUM7Ozs7Ozs7Ozs7O0FBRWIsbUNBQStFO0FBSS9FLE1BQWEsWUFBYSxTQUFRLGtCQUFTO0lBSXZDLFlBQVksT0FBd0I7UUFDaEMsS0FBSyxpQkFBRSxrQkFBa0IsRUFBQyxJQUFJLElBQUssT0FBTyxFQUFFLENBQUM7UUFKekMsbUJBQWMsR0FBVSxFQUFFLENBQUM7UUFDM0IsVUFBSyxHQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDMUIsVUFBSyxHQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFHaEMsQ0FBQztJQUNELFVBQVUsQ0FBQyxLQUFZLEVBQUUsU0FBZ0IsRUFBRSxJQUFzQjtRQUM3RCxJQUFJLEtBQUssR0FBQyxDQUFDLENBQUM7UUFDWixJQUFJLEdBQVUsQ0FBQztRQUNmLE9BQU0sQ0FBQyxHQUFHLEdBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUMsS0FBSyxDQUFDLENBQUMsSUFBRSxDQUFDLENBQUMsRUFBQztZQUNwQyxJQUFJLE1BQU0sR0FBRyxHQUFHLElBQUksS0FBSyxDQUFDLEdBQUcsR0FBQyxDQUFDLENBQUMsSUFBRSxFQUFFLENBQUM7WUFDckMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFDLElBQUksRUFBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsY0FBYyxFQUFFLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFDLEdBQUcsR0FBQyxDQUFDLE1BQU0sQ0FBQSxDQUFDLENBQUEsQ0FBQyxDQUFBLENBQUMsQ0FBQSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUMsTUFBTSxDQUFBLENBQUMsQ0FBQSxJQUFJ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SSxDQUFDLFVBQVUsRUFBQztZQUN0QixJQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUM7Z0JBQ3hCLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztnQkFDbEMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7Z0JBQzlCLEtBQUssR0FBQyxHQUFHLENBQUM7YUFDYjtZQUNELEdBQUcsRUFBRSxDQUFDO1NBQ1Q7UUFDRCxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUM5QixJQUFHLElBQUksQ0FBQyxJQUFJLEtBQUssT0FBTyxFQUFDO1lBQ3JCLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBQyxJQUFJLEVBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFpQixDQUFDLEVBQUUsR0FBRyxFQUFFLEtBQXFCLENBQUMsR0FBRyxFQUFDLENBQUMsQ0FBQTtTQUNyRjtRQUNELElBQUksRUFBRSxDQUFDO0lBQ1gsQ0FBQztDQUNKO0FBMUNELG9EQTBDQztBQUVNLEtBQUssVUFBVSxpQkFBaUIsQ0FBQyxNQUFhO0lBQ2pELE9BQU8sSUFBSSxPQUFPLENBQUMsVUFBUyxPQUFPLEVBQUUsTUFBTTtRQUN2QyxNQUFNLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUUsQ0FBQztRQUM1QixNQUFNLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUM1QixNQUFNLENBQUMsRUFBRSxDQUFDLEtBQUssRUFBSSxPQUFPLENBQUMsQ0FBQztJQUNoQyxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUM7QUFORCw4Q0FNQyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5cclxuaW1wb3J0IHsgVHJhbnNmb3JtLCBUcmFuc2Zvcm1DYWxsYmFjaywgVHJhbnNmb3JtT3B0aW9ucywgU3RyZWFtIH0gZnJvbSBcInN0cmVhbVwiXHJcblxyXG5leHBvcnQgdHlwZSBMaW5lRWxlbWVudCA9IHtsaW5lOkJ1ZmZlciwgZW9sOkJ1ZmZlcn07XHJcblxyXG5leHBvcnQgY2xhc3MgTGluZVNwbGl0dGVyIGV4dGVuZHMgVHJhbnNmb3JtIHtcclxuICAgIHByaXZhdGUgaW50ZXJuYWxCdWZmZXI6QnVmZmVyW109W107XHJcbiAgICBwcml2YXRlIGVvbDEzPUJ1ZmZlci5mcm9tKCdcXHJcXG4nKTtcclxuICAgIHByaXZhdGUgZW9sMTA9QnVmZmVyLmZyb20oJ1xcbicpO1xyXG4gICAgY29uc3RydWN0b3Iob3B0aW9uczpUcmFuc2Zvcm1PcHRpb25zKSB7XHJcbiAgICAgICAgc3VwZXIoe3JlYWRhYmxlT2JqZWN0TW9kZTp0cnVlLCAuLi5vcHRpb25zfSk7XHJcbiAgICB9XHJcbiAgICBfdHJhbnNmb3JtKGNodW5rOkJ1ZmZlciwgX2VuY29kaW5nOnN0cmluZywgbmV4dDpUcmFuc2Zvcm1DYWxsYmFjayl7XHJcbiAgICAgICAgdmFyIGluZGV4PTA7XHJcbiAgICAgICAgdmFyIHBvczpudW1iZXI7XHJcbiAgICAgICAgd2hpbGUoKHBvcz1jaHVuay5pbmRleE9mKDEwLGluZGV4KSkhPS0xKXtcclxuICAgICAgICAgICAgdmFyIHdpdGgxMyA9IHBvcyAmJiBjaHVua1twb3MtMV09PTEzO1xyXG4gICAgICAgICAgICB0aGlzLnB1c2goe2xpbmU6QnVmZmVyLmNvbmNhdChbLi4udGhpcy5pbnRlcm5hbEJ1ZmZlciwgY2h1bmsuc2xpY2UoaW5kZXgscG9zLSh3aXRoMTM/MTowKSldKSwgZW9sOndpdGgxMz90aGlzLmVvbDEzOnRoaXMuZW9sMTB9KVxyXG4gICAgICAgICAgICB0aGlzLmludGVybmFsQnVmZmVyPVtdO1xyXG4gICAgICAgICAgICBpbmRleD1wb3MrMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbnRlcm5hbEJ1ZmZlci5wdXNoKGNodW5rLnNsaWNlKGluZGV4KSk7XHJcbiAgICAgICAgbmV4dCgpO1xyXG4gICAgfVxyXG4gICAgX2ZsdXNoKGRvbmU6VHJhbnNmb3JtQ2FsbGJhY2spe1xyXG4gICAgICAgIGlmKHRoaXMuaW50ZXJuYWxCdWZmZXIubGVuZ3RoICYmIHRoaXMuaW50ZXJuYWxCdWZmZXIuZmluZCh4PT54Lmxlbmd0aD4wIHx8IHguYnl0ZUxlbmd0aD4wKSl7XHJcbiAgICAgICAgICAgIHRoaXMucHVzaCh7bGluZTpCdWZmZXIuY29uY2F0KHRoaXMuaW50ZXJuYWxCdWZmZXIpLCBlb2w6QnVmZmVyLmZyb20oJycpfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvbmUoKTtcclxuICAgIH1cclxufSAgICAgICAgICBcclxuXHJcbmV4cG9ydCBjbGFzcyBMaW5lSm9pbmVyIGV4dGVuZHMgVHJhbnNmb3JtIHtcclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnM6VHJhbnNmb3JtT3B0aW9ucykge1xyXG4gICAgICAgIHN1cGVyKHt3cml0YWJsZU9iamVjdE1vZGU6dHJ1ZSwgLi4ub3B0aW9uc30pO1xyXG4gICAgfVxyXG4gICAgX3RyYW5zZm9ybShjaHVuazpMaW5lRWxlbWVudCwgX2VuY29kaW5nOnN0cmluZywgbmV4dDpUcmFuc2Zvcm1DYWxsYmFjayl7XHJcbiAgICAgICAgdGhpcy5wdXNoKGNodW5rLmxpbmUpO1xyXG4gICAgICAgIHRoaXMucHVzaChjaHVuay5lb2wpO1xyXG4gICAgICAgIG5leHQoKTtcclxuICAgIH1cclxufSAgICAgICAgICBcclxuXHJcbmV4cG9ydCB0eXBlIEVzY2FwZUNoYXJzVHJhbnNmb3JtTW9kZT0nbGluZXMnO1xyXG5leHBvcnQgdHlwZSBFc2NhcGVDaGFyc1RyYW5zZm9ybU9wdGlvbnM9e2NoYXJzVG9Fc2NhcGU6c3RyaW5nLCBwcmVmaXhDaGFyOnN0cmluZ30gJiBUcmFuc2Zvcm1PcHRpb25zO1xyXG5cclxuZXhwb3J0IGNsYXNzIEVzY2FwZUNoYXJzVHJhbnNmb3JtIGV4dGVuZHMgVHJhbnNmb3JtIHtcclxuICAgIHByaXZhdGUgY2hhcnNNYXA6e1trZXk6c3RyaW5nXTogdHJ1ZX07XHJcbiAgICBwcml2YXRlIHByZWZpeEJ1ZmZlcjpCdWZmZXI7XHJcbiAgICBwcml2YXRlIG1vZGU6RXNjYXBlQ2hhcnNUcmFuc2Zvcm1Nb2RlfHVuZGVmaW5lZDtcclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnM6RXNjYXBlQ2hhcnNUcmFuc2Zvcm1PcHRpb25zLCBtb2RlPzpFc2NhcGVDaGFyc1RyYW5zZm9ybU1vZGUpIHtcclxuICAgICAgICB2YXIge2NoYXJzVG9Fc2NhcGUsIHByZWZpeENoYXIsIC4uLnN1cGVyT3B0aW9uc30gPSBvcHRpb25zO1xyXG4gICAgICAgIHN1cGVyKHtvYmplY3RNb2RlOm1vZGU9PT0nbGluZXMnLCAuLi5zdXBlck9wdGlvbnN9KTtcclxuICAgICAgICB0aGlzLnByZWZpeEJ1ZmZlcj1CdWZmZXIuYWxsb2MoMSxwcmVmaXhDaGFyKTtcclxuICAgICAgICB0aGlzLmNoYXJzTWFwPXt9O1xyXG4gICAgICAgIHRoaXMubW9kZT1tb2RlO1xyXG4gICAgICAgIHZhciBzZWxmPXRoaXM7XHJcbiAgICAgICAgY2hhcnNUb0VzY2FwZS5zcGxpdCgnJykuZm9yRWFjaChmdW5jdGlvbihjaGFyKXtcclxuICAgICAgICAgICAgdmFyIGFzY2lpOm51bWJlcj1jaGFyLmNoYXJDb2RlQXQoMCk7XHJcbiAgICAgICAgICAgIHNlbGYuY2hhcnNNYXBbYXNjaWldPXRydWU7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIF90cmFuc2Zvcm0oY2h1bms6TGluZUVsZW1lbnR8QnVmZmVyLCBfZW5jb2Rpbmc6c3RyaW5nLCBuZXh0OlRyYW5zZm9ybUNhbGxiYWNrKXtcclxuICAgICAgICB2YXIgaW5kZXg9MDtcclxuICAgICAgICB2YXIgcG9zPTA7XHJcbiAgICAgICAgdmFyIGxpbmU6QnVmZmVyO1xyXG4gICAgICAgIHZhciBwYXJ0czp7cHVzaDoocGFydDpCdWZmZXIpPT52b2lkfTtcclxuICAgICAgICBpZih0aGlzLm1vZGUgPT09ICdsaW5lcycpe1xyXG4gICAgICAgICAgICBwYXJ0cz1bXSBhcyBCdWZmZXJbXTtcclxuICAgICAgICAgICAgbGluZT0oY2h1bmsgYXMgTGluZUVsZW1lbnQpLmxpbmU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHBhcnRzPXRoaXM7XHJcbiAgICAgICAgICAgIGxpbmU9Y2h1bmsgYXMgQnVmZmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgICB3aGlsZShwb3M8bGluZS5ieXRlTGVuZ3RoKXtcclxuICAgICAgICAgICAgaWYodGhpcy5jaGFyc01hcFtsaW5lW3Bvc11dKXtcclxuICAgICAgICAgICAgICAgIHBhcnRzLnB1c2gobGluZS5zbGljZShpbmRleCxwb3MpKTtcclxuICAgICAgICAgICAgICAgIHBhcnRzLnB1c2godGhpcy5wcmVmaXhCdWZmZXIpO1xyXG4gICAgICAgICAgICAgICAgaW5kZXg9cG9zO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBvcysrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBwYXJ0cy5wdXNoKGxpbmUuc2xpY2UoaW5kZXgpKTtcclxuICAgICAgICBpZih0aGlzLm1vZGUgPT09ICdsaW5lcycpe1xyXG4gICAgICAgICAgICB0aGlzLnB1c2goe2xpbmU6QnVmZmVyLmNvbmNhdChwYXJ0cyBhcyBCdWZmZXJbXSksIGVvbDooY2h1bmsgYXMgTGluZUVsZW1lbnQpLmVvbH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIG5leHQoKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0cmVhbVNpZ25hbHNEb25lKHN0cmVhbTpTdHJlYW0pOlByb21pc2U8dm9pZD57XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcclxuICAgICAgICBzdHJlYW0ub24oJ2Vycm9yJywgcmVqZWN0ICk7XHJcbiAgICAgICAgc3RyZWFtLm9uKCdjbG9zZScsIHJlc29sdmUpO1xyXG4gICAgICAgIHN0cmVhbS5vbignZW5kJyAsICByZXNvbHZlKTtcclxuICAgIH0pO1xyXG59XHJcbiJdfQ==